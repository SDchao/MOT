# info.json文件格式

## 文件功能

info.json文件包含了此数据目录下的所有视频信息与地图文件信息。

展示界面会依据info.json读取数据文件夹中的图片、MOT信息等。

## 文件示例

请注意，所有的双斜线注释内容并不被展示界面的运行环境支持！

在生产环境创建json文件时请不要携带任何注释。

**文件应当采用UTF-8编码**

```json5
{
  "name": "路径1-武大正门",
  // 此数据文件夹的名称，运行时会成为展示界面的窗口标题
  "mapPos": [
    // 同目录下map.jpg上，摄像头的坐标点。
    "514 534",
    // 这是地图上的第一个摄像头地点，对应的mapPosIndex值为0
    "590 439"
    // 对应的mapPosIndex值为1
  ],
  "cameras": [
    // 摄像头及其对应监控视频的信息
    {
      "name": "文-3001",
      // 摄像头名称
      "mapPosIndex": "0",
      // 摄像头所在的地图坐标
      "videos": [
        // 摄像头所录制的视频文件列表，格式为[视频文件名，索引号]
        [
          "文-3001-牌坊东小路_2020-07-22_13h38min10s.avi",
          0
        ],
        // 该索引号为0，将出现在界面中预览列表的第一位
        [
          "文-3001-牌坊东小路_2020-07-22_13h46min57s.avi",
          3
        ]
      ]
    },
    {
      "name": "文-3002",
      "mapPosIndex": "1",
      "videos": [
        [
          "文-3002-牌坊正面_2020-07-22_13h38min51s.avi",
          1
        ],
        [
          "文-3002-牌坊正面_2020-07-22_13h46min16s.avi",
          2
        ]
      ]
    }
  ]
}
```

# 视频文件格式

## 储存位置

为了便于展示界面批量导入视频文件，所有的视频文件需存储于项目文件夹下的videos路径。

同时，该视频的文件名还需要写入info.json中，否则将不会被展示界面读取。

例如，在/home/data中添加1.avi文件后，正确的项目文件格式如下：

```
/home/data/videos/1.avi
/home/data/info.json
/home/data/map.jpg
```

其中，info.json中，cameras 下 videos 中需包含 1.avi，否则展示界面将不会读取1.avi的相关信息

# MOT文件格式

## 文件信息

MOT文件包含了视频中每一帧所有的Tracking box的位置大小、与其对应ID的信息。

## 储存位置

MOT文件需要与视频文件处于同一个目录下，文件名与视频文件相同，后缀为".data"

例如，"video1.avi"的MOT文件命名必须为"video1.data"，且文件结构如下：

```
/home/data/videos/video1.avi
/home/data/videos/video1.data
/home/data/info.json 其中需包含video1.avi的信息
/home/data/map.jpg
```

## 文件示例

**文件应当采用UTF-8编码**

```
# 以'#'符号开头的行为注释
# 帧数,人物ID,坐标x,坐标y,宽度w,高度h,占位-1,占位-1,占位-1,占位-1
# 占位-1不可以省略
2,1,733,88,45,140,-1,-1,-1,-1
2,2,685,94,48,152,-1,-1,-1,-1
```

# WS文件格式

## 文件信息

ws文件包含了MOT信息中人物的跟随关系与概率

## 储存位置

ws文件需要与对应视频文件、MOT文件处于同一目录下 例如，"video1.data"的ws文件必须为"video1.ws"，且文件结构如下：

```
/home/data/videos/video1.avi
/home/data/videos/video1.data
/home/data/videos/video1.ws
/home/data/info.json 其中需包含video1.avi的信息
/home/data/map.jpg
```

## 文件实例

**文件应当采用UTF-8编码**

```
# 以'#'符号开头的行为注释
# 被尾随id<-尾随id,概率
# 每行只允许出现两个id
2<-1,0.162
2<-3,0.1089
```

# ReID文件格式

ReID文件包含了视频基于MOT信息的截图与reid关系的数据文件

## 储存位置

所有与ReID有关的文件均保存在数据文件夹下image目录下。

例如项目文件中有两个视频："A.avi"、"B.avi"。同时A.avi在info.json中的索引为0，B.avi在info.json中索引为1。

此项目文件结构如下：

```
data/info.json
data/map.jpg

data/videos/A.avi
data/videos/A.data
data/videos/A.ws
data/videos/B.avi
data/videos/B.data
data/videos/B.ws

A.avi中的截图：
data/image/1/c1_1_10_731_90_775_227.jpg
data/image/1/c1_2_10_683_96_728_246.jpg

B.avi中的截图
data/image/2/c2_1_520_81_714_246_1079.jpg
data/image/2/c2_2_150_19_671_160_1079.jpg

A-> B ReID的标注数据
data/image/reid_data/1-2/c1_1_10_731_90_775_227.txt
data/image/reid_data/1-2/c1_2_10_683_96_728_246.txt

B -> A ReID的标注数据
data/image/reid_data/2-1/c2_1_520_81_714_246_1079.txt
data/image/reid_data/2-1/c2_2_150_19_671_160_1079.txt
```

## 文件格式
### 图像格式
图像文件的命名格式如下：

摄像头编号_人物ID_帧数_x1_y1_x2_y2.jpg

例如：data/image/reid_data/1-2/c1_1_10_731_90_775_227.jpg

### 标注格式
#### 目录格式
reid_data中的文件格式相对复杂。ReID仅接受视频索引号相邻的标注文件。

例如0号视频A.avi到1号视频B.avi的标注数据储存在此目录下：

data/image/reid_data/1-2/

目录中**不应该**出现这种不相邻的标注数据：

data/image/reid_data/1-3/
#### 文件名格式
标注数据的文件名应当与截图的文件名保持一致，后缀为".txt"
```
data/image/1/c1_1_10_731_90_775_227.jpg
data/image/reid_data/1-2/c1_1_10_731_90_775_227.txt
```

#### 文件内容
文件内容为ReID识别到相同人物的截图文件名。概率从上往下依次降低。

例如data/image/reid_data/1-2/c1_1_10_731_90_775_227.txt的内容如下：
```text
c2_1_530_164_728_348_1079.jpg
c2_9_1350_1650_268_1759_620.jpg
c2_1_540_224_735_411_1079.jpg
c2_1_550_296_712_473_1079.jpg
c2_1_590_600_709_766_1079.jpg
c2_9_1490_1669_270_1748_590.jpg
c2_1_520_81_714_246_1079.jpg
c2_1_1320_1615_248_1719_541.jpg
c2_9_1550_1726_282_1823_583.jpg
c2_9_1420_1673_274_1775_590.jpg

```

这说明根据视频0中截图 c1_1_10_731_90_775_227.jpg，视频1中截图 c2_1_530_164_728_348_1079.jpg 与该截图为同一ID。